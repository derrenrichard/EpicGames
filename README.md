# Epic Games

This repository contains SQL scripts for managing the schema and data for a game application database in Oracle.

## Table Names

All table names used in these scripts are in **lowercase** and **plural** form.

## Scripts Overview

This repository includes the following SQL scripts:

1.  `ddl.sql`
2.  `delete_ddl_tables.sql`
3.  `delete_all_tables.sql`

---

### 1. `ddl.sql`: Database Schema and Data Script

This script contains the Data Definition Language (DDL) to create the tables for the game application database based on the provided Entity-Relationship Diagram (ERD), and Data Manipulation Language (DML) to populate these tables with dummy data.

#### Table Structure

The script defines the following tables:

* `users`
* `customers`
* `developers`
* `achievements`
* `userachievements`
* `gameservers`
* `genres`
* `games`
* `userlibrary`
* `purchases`
* `gamereviews`

#### Important Considerations

* **IDENTITY Columns**: Tables with `id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY` have their `id` values automatically generated by Oracle. You should not provide `id` values for these tables in `INSERT` statements.
* **Foreign Key Dependencies**: The DML section handles the insertion order carefully, especially for `customers` and `developers` tables, which derive their `id` from the `users` table's generated IDs. A PL/SQL block is used to manage this.
* **Reserved Keyword**: The `LEVEL` column in the `customers` table was renamed to `customer_level` to avoid conflict with Oracle's reserved keyword.

#### How to Use

1.  **Prepare Your Oracle Environment**:
    * Connect to your Oracle database as a privileged user (e.g., `SYSTEM` or `SYS AS SYSDBA`).
    * Create a dedicated user/schema for this application if you haven't already. For example:
        ```sql
        CREATE USER game_app_user IDENTIFIED BY YourSecurePassword123
        DEFAULT TABLESPACE users
        TEMPORARY TABLESPACE temp
        QUOTA UNLIMITED ON users;

        GRANT CONNECT, RESOURCE, CREATE VIEW, CREATE SESSION, UNLIMITED TABLESPACE TO game_app_user;
        COMMIT;
        ```

2.  **Connect as the Application User**:
    * Connect to your Oracle database using the newly created user (e.g., `game_app_user`):
        ```sql
        CONNECT game_app_user/YourSecurePassword123@your_service_name
        ```

3.  **Run the Script**:
    * Save this script as `ddl.sql`.
    * Execute the script in your Oracle client (e.g., SQL Developer, SQL*Plus) by typing `@ddl.sql` or running it directly from the IDE.

#### Verification

After running, you can use individual `SELECT * FROM table_name;` queries for each table to verify that tables are created and populated with data.

---

### 2. `delete_ddl_tables.sql`: Specific Table Deletion Script

This script is designed to **permanently delete** only the specific tables that were created by the `ddl.sql` script. It explicitly lists each table to be dropped, ensuring that no other tables in the schema are affected.

#### Tables Targeted for Deletion

The script will attempt to drop the following tables:

* `gamereviews`
* `purchases`
* `userlibrary`
* `games`
* `userachievements`
* `customers`
* `developers`
* `gameservers`
* `genres`
* `achievements`
* `users`

#### WARNING - Data Loss!

* **This script will permanently remove all data and the table structures** for the listed tables from the connected schema.
* **THERE IS NO UNDO** once this script is executed and committed.
* **Ensure you have a backup** if the data in these tables is valuable.
* **Use with extreme caution.**

#### How it Works

The script uses `DROP TABLE table_name CASCADE CONSTRAINTS;` for each specified table. `CASCADE CONSTRAINTS` ensures that any foreign key constraints referencing the table being dropped are also removed, preventing errors due to dependencies. Each `DROP` statement is wrapped in an exception block to allow the script to continue even if a specific table drop fails.

#### How to Use

1.  **Connect to the Correct Schema**:
    * It is crucial to connect as the user who owns these tables (e.g., `game_app_user`).
        ```sql
        CONNECT game_app_user/YourSecurePassword123@your_service_name
        ```
    * **DO NOT run this script as a SYSDBA or SYSTEM user unless you explicitly understand the consequences, as it might attempt to drop tables in the wrong schema.**

2.  **Run the Script**:
    * Save this script as `delete_ddl_tables.sql`.
    * Execute the script in your Oracle client (e.g., SQL Developer, SQL*Plus) by typing `@delete_ddl_tables.sql` or running it directly from the IDE.

#### Verification

After running, you can try to `SELECT * FROM table_name;` for any of the listed tables. You should receive an `ORA-00942: table or view does not exist` error, indicating successful deletion.

---

### 3. `delete_all_tables.sql`: Comprehensive Table Deletion Script

This script is a powerful tool designed to **permanently delete ALL tables** owned by the currently connected user in an Oracle database. It dynamically queries the `USER_TABLES` data dictionary view to identify all tables and then generates and executes `DROP TABLE` statements for each of them.

#### WARNING - EXTREME DATA LOSS RISK!

* **This script will permanently remove ALL tables and their data** from the schema you are connected to.
* **THERE IS NO UNDO** once this script is executed and committed.
* **USE THIS SCRIPT WITH THE UTMOST CAUTION.**
* **Ensure you have a complete and recent backup** of your database or schema if the data is valuable.

#### How it Works

The script uses a PL/SQL block to:
1.  Query `user_tables` to get the names of all tables owned by the current user.
2.  For each table found, it constructs and executes a `DROP TABLE table_name CASCADE CONSTRAINTS;` command.
3.  `CASCADE CONSTRAINTS` is used to automatically remove any foreign key relationships that would otherwise prevent the tables from being dropped.
4.  Includes basic error handling for each drop operation, allowing the script to continue even if some tables cannot be dropped (e.g., due to specific locks or permissions).

#### How to Use

1.  **Connect to the Target Schema (CRITICAL)**:
    * **Ensure you are connected to the EXACT schema (user)** whose tables you intend to delete.
        ```sql
        CONNECT your_username/your_password@your_service_name
        ```
    * **NEVER run this script as a highly privileged user like `SYS AS SYSDBA` or `SYSTEM` unless you are absolutely certain and intend to clear ALL objects across many schemas, which is usually not the desired outcome.** Running this as `SYS` or `SYSTEM` could lead to catastrophic data loss.

2.  **Run the Script**:
    * Save this script as `delete_all_tables.sql`.
    * Execute the script in your Oracle client (e.g., SQL Developer, SQL*Plus) by typing `@delete_all_tables.sql` or running it directly from the IDE.

#### Verification

After execution, you can try to query `SELECT table_name FROM user_tables;`. The result set should be empty, confirming that all tables have been deleted. You can also try to `SELECT * FROM any_old_table_name;` and expect an `ORA-00942: table or view does not exist` error.
